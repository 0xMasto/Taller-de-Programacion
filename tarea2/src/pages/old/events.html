<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventos - eventos.uy</title>
    <link rel="stylesheet" href="../../css/eventos-app.css">
</head>
<body>
    <div class="auth-links">
        <div id="guestAuth">
            <a href="login.html">Iniciar Sesión</a> / <a href="register.html">Registrarse</a>
        </div>
        <div id="userAuth" style="display: none;">
            <div class="user-info">
                <div class="user-profile-section">
                    <div class="user-avatar" id="userAvatar">
                        <img id="userImage" src="" alt="" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; display: none;">
                        <span id="userInitial">U</span>
                    </div>
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuario</span>
                        <div class="user-actions">
                            <a href="#" id="userProfileLink" style="color: #007bff; text-decoration: none; font-size: 12px;">Ver Perfil</a>
                            <span style="color: #ccc; margin: 0 5px;">|</span>
                            <a href="#" onclick="logout()" style="color: #dc3545; text-decoration: none; font-size: 12px;">Cerrar Sesión</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-layout">
        <!-- Sidebar -->
        <div class="sidebar">
            <a href="../../index.html" class="logo">Eventos.uy</a>
            
            <!-- Profile Section (only for logged in users) -->
            <div class="profile-section" id="profileSection" style="display: none;">
                <div class="profile-header">Mi Perfil</div>
                <div class="profile-options">
                    <a href="user-profile.html?nickname=" id="profileLink">Modificar Datos de Usuario</a>
                    <a href="consulta-registro.html" id="assistantLink">Mis Registros</a>
                    <a href="alta-evento.html" id="organizerLink1" style="display: none;">Alta Evento</a>
                    <a href="alta-edicion.html" id="organizerLink2" style="display: none;">Alta Edición</a>
                    <a href="alta-institucion.html" id="organizerLink3" style="display: none;">Alta Institución</a>
                </div>
            </div>

            

            <!-- Categories -->
            <div class="sidebar-section">
                <div class="sidebar-title">Categorías</div>
                <ul class="category-list">
                    <li><a href="index.html" data-category="tecnología">Tecnología</a></li>
                    <li><a href="index.html" data-category="innovación">Innovación</a></li>
                    <li><a href="index.html" data-category="deporte">Deporte</a></li>
                    <li><a href="index.html" data-category="salud">Salud</a></li>
                </ul>
            </div>

            <!-- Users -->
            <div class="users-section">
                <div class="sidebar-title">
                    <a href="users.html" style="color: #333; text-decoration: underline;">Usuarios</a>
                </div>
            </div>            
        </div>

        <!-- Main Content -->
        <div class="content-area">
            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Eventos, Ediciones">
                <button class="search-btn">Buscar</button>
            </div>

            <!-- Events List -->

            <ul class="events-list">
                <!-- Event 1: Conferencia de Tecnología -->
                <a href="event-detail.html?id=EV01" style="color: #333; text-decoration: none;">
                    <li class="event-card">
                        <div class="event-image">Conferencia<br>Tecnología</div>
                        <div class="event-content">
                            <h3>Conferencia de Tecnología</h3>
                            <p>Evento sobre innovación tecnológica</p>
                            <small style="color: #999;">
                                Categorías: Tecnología, Innovación | 3 edición(es)
                            </small>
                        </div>
                    </li>
                </a>

                <!-- Event 2: Maratón de Montevideo -->
                <a href="event-detail.html?id=EV04" style="color: #333; text-decoration: none;">
                <li class="event-card">
                    <div class="event-image">
                        <img src="../../../imagens/IMG-EV04.png" alt="Maratón de Montevideo" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
                    </div>
                    <div class="event-content">
                        <h3>Maratón de Montevideo</h3>
                        <p>Competencia deportiva anual en la capital</p>
                        <small style="color: #999;">
                            Categorías: Deporte, Salud | 2 edición(es)
                        </small>
                    </div>
                </li>
                </a>
            </ul>
        </div>
    </div>

    <script>
        // Check login state and update UI
        function checkLoginState() {
            const currentUser = localStorage.getItem('currentUser');
            const guestAuth = document.getElementById('guestAuth');
            const userAuth = document.getElementById('userAuth');
            const profileSection = document.getElementById('profileSection');
            const profileLink = document.getElementById('profileLink');
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            const userImage = document.getElementById('userImage');
            const userInitial = document.getElementById('userInitial');
            const userProfileLink = document.getElementById('userProfileLink');
            
            if (currentUser) {
                const user = JSON.parse(currentUser);
                guestAuth.style.display = 'none';
                userAuth.style.display = 'block';
                profileSection.style.display = 'block';
                
                // Update user name in header
                userName.textContent = user.name;
                
                // Update profile links with user nickname
                profileLink.href = `user-profile.html?nickname=${user.nickname}`;
                userProfileLink.href = `user-profile.html?nickname=${user.nickname}`;
                
                // Update user avatar - try to show image, fallback to initial
                if (user.image) {
                    userImage.src = `../../imagens/${user.image}`;
                    userImage.alt = user.name;
                    userImage.style.display = 'block';
                    userInitial.style.display = 'none';
                    
                    // Handle image load error
                    userImage.onerror = function() {
                        userImage.style.display = 'none';
                        userInitial.style.display = 'flex';
                        userInitial.textContent = user.name.charAt(0).toUpperCase();
                    };
                } else {
                    userImage.style.display = 'none';
                    userInitial.style.display = 'flex';
                    userInitial.textContent = user.name.charAt(0).toUpperCase();
                }
                
                // Show/hide user-type-specific options
                const assistantLink = document.getElementById('assistantLink');
                const organizerLink1 = document.getElementById('organizerLink1');
                const organizerLink2 = document.getElementById('organizerLink2');
                const organizerLink3 = document.getElementById('organizerLink3');
                
                if (user.type === 'organizador') {
                    // Show organizer options, hide assistant options
                    if (assistantLink) assistantLink.style.display = 'none';
                    if (organizerLink1) organizerLink1.style.display = 'block';
                    if (organizerLink2) organizerLink2.style.display = 'block';
                    if (organizerLink3) organizerLink3.style.display = 'block';
                } else {
                    // Show assistant options, hide organizer options
                    if (assistantLink) assistantLink.style.display = 'block';
                    if (organizerLink1) organizerLink1.style.display = 'none';
                    if (organizerLink2) organizerLink2.style.display = 'none';
                    if (organizerLink3) organizerLink3.style.display = 'none';
                }
            } else {
                guestAuth.style.display = 'block';
                userAuth.style.display = 'none';
                profileSection.style.display = 'none';
            }
        }

        // Logout function
        function logout() {
            localStorage.removeItem('currentUser');
            window.location.reload();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginState();
        });
    </script>

</body>
</html>
