<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle del Evento - eventos.uy</title>
    <link rel="stylesheet" href="../css/eventos-app.css">
</head>
<body>
    <div class="auth-links">
        <div id="guestAuth">
            <a href="login.html">Iniciar Sesión</a> / <a href="register.html">Registrarse</a>
        </div>
        <div id="userAuth" style="display: none;">
            <div class="user-info">
                <div class="user-profile-section">
                    <div class="user-avatar" id="userAvatar">
                        <img id="userImage" src="" alt="" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; display: none;">
                        <span id="userInitial">U</span>
                    </div>
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuario</span>
                        <div class="user-actions">
                            <a href="#" id="userProfileLink" style="color: #007bff; text-decoration: none; font-size: 12px;">Ver Perfil</a>
                            <span style="color: #ccc; margin: 0 5px;">|</span>
                            <a href="#" onclick="logout()" style="color: #dc3545; text-decoration: none; font-size: 12px;">Cerrar Sesión</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-layout">
        <!-- Sidebar -->
        <div class="sidebar">
            <a href="../index.html" class="logo">Eventos.uy</a>
            
            <!-- Profile Section (only for logged in users) -->
            <div class="profile-section" id="profileSection" style="display: none;">
                <div class="profile-header">Mi Perfil</div>
                <div class="profile-options">
                    <a href="user-profile.html?nickname=" id="profileLink">Modificar Datos de Usuario</a>
                    <a href="consulta-registro.html" id="assistantLink">Mis Registros</a>
                    <a href="alta-evento.html" id="organizerLink1" style="display: none;">Alta Evento</a>
                    <a href="alta-edicion.html" id="organizerLink2" style="display: none;">Alta Edición</a>
                    <a href="alta-institucion.html" id="organizerLink3" style="display: none;">Alta Institución</a>
                </div>
            </div>


            <!-- Categories -->
            <div class="sidebar-section">
                <div class="sidebar-title">Categorías</div>
                <ul class="category-list">
                    <li><a href="events.html">Tecnología</a></li>
                    <li><a href="events.html">Innovación</a></li>
                    <li><a href="events.html">Deporte</a></li>
                    <li><a href="events.html">Salud</a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content-area">
            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Eventos, Ediciones">
                <button class="search-btn">Buscar</button>
            </div>

            <!-- Event Detail -->
            <div class="event-detail-container">
                <div class="event-main">
                    <!-- Event EV01: Conferencia de Tecnología -->
                    <div id="event-EV01" class="event-content" style="display: none;">
                        <div class="event-image">Conferencia<br>Tecnología</div>
                        <div class="event-info">
                            <h2>Conferencia de Tecnología</h2>
                            <p><strong>Descripción:</strong> Evento sobre innovación tecnológica</p>
                            <p><strong>Sigla:</strong> CONFTEC</p>
                            <p><strong>Categorías:</strong> Tecnología, Innovación</p>
                            <p><strong>Fecha Alta:</strong> 10/01/2025</p>
                        </div>
                    </div>

                    <!-- Event EV04: Maratón de Montevideo -->  
                    <div id="event-EV04" class="event-content" style="display: none;">
                        <div class="event-image">
                            <img src="../../imagens/IMG-EV04.png" alt="Maratón de Montevideo" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
                        </div>
                        <div class="event-info">
                            <h2>Maratón de Montevideo</h2>
                            <p><strong>Descripción:</strong> Competencia deportiva anual en la capital</p>
                            <p><strong>Sigla:</strong> MARATON</p>
                            <p><strong>Categorías:</strong> Deporte, Salud</p>
                            <p><strong>Fecha Alta:</strong> 01/01/2022</p>
                        </div>
                    </div>

                    <!-- Default/Error State -->
                    <div id="event-default" class="event-content">
                        <div class="event-image">404</div>
                        <div class="event-info">
                            <h2>Evento no encontrado</h2>
                            <p>El evento solicitado no existe.</p>
                            <p><a href="events.html">← Volver a Eventos</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Editions Sidebar -->
        <div class="editions-sidebar">
            <div class="editions-section">
                <div class="editions-header">Ediciones</div>
                
                <!-- Editions for EV01: Conferencia de Tecnología -->
                <div id="editions-EV01" class="editions-content" style="display: none;">
                    <div class="editions-list">
                        <!-- Edition 1: Tecnología Punta del Este 2026 -->
                        <a href="edition-detail.html?id=EDEV08" class="edition-link">
                            <div class="edition-item">
                                <div class="edition-image">Tecnología<br>2026</div>
                                <div class="edition-content">
                                    <div class="edition-name">Tecnología Punta del Este 2026</div>
                                    <small style="color: #666;">
                                        Punta del Este, Uruguay | 06/04/2026 - 10/04/2026 | Estado: Aceptada
                                    </small>
                                </div>
                            </div>
                        </a>

                        <!-- Edition 2: Mobile World Congress 2025 -->
                        <a href="edition-detail.html?id=EDEV09" class="edition-link">
                            <div class="edition-item">
                                <div class="edition-image">
                                    <img src="../../imagens/IMG-EDEV09.png" alt="Mobile World Congress 2025" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
                                </div>
                                <div class="edition-content">
                                    <div class="edition-name">Mobile World Congress 2025</div>
                                    <small style="color: #666;">
                                        Barcelona, España | 12/12/2025 - 15/12/2025 | Estado: Ingresada
                                    </small>
                                </div>
                            </div>
                        </a>

                        <!-- Edition 3: Web Summit 2026 -->
                        <a href="edition-detail.html?id=EDEV10" class="edition-link">
                            <div class="edition-item">
                                <div class="edition-image">Web<br>Summit</div>
                                <div class="edition-content">
                                    <div class="edition-name">Web Summit 2026</div>
                                    <small style="color: #666;">
                                        Lisboa, Portugal | 13/01/2026 - 01/02/2026 | Estado: Aceptada
                                    </small>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Editions for EV04: Maratón de Montevideo -->
                <div id="editions-EV04" class="editions-content" style="display: none;">
                    <div class="editions-list">
                        <!-- Edition 1: Maratón de Montevideo 2024 -->
                        <a href="edition-detail.html?id=EDEV03" class="edition-link">
                            <div class="edition-item">
                                <div class="edition-image">
                                    <img src="../../imagens/IMG-EDEV03.jpeg" alt="Maratón de Montevideo 2024" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
                                </div>
                                <div class="edition-content">
                                    <div class="edition-name">Maratón de Montevideo 2024</div>
                                    <small style="color: #666;">
                                        Montevideo, Uruguay | 14/09/2024 | Estado: Aceptada
                                    </small>
                                </div>
                            </div>
                        </a>

                        <!-- Edition 2: Maratón de Montevideo 2022 -->
                        <a href="edition-detail.html?id=EDEV04" class="edition-link">
                            <div class="edition-item">
                                <div class="edition-image">
                                    <img src="../../imagens/IMG-EDEV04.jpeg" alt="Maratón de Montevideo 2022" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">
                                </div>
                                <div class="edition-content">
                                    <div class="edition-name">Maratón de Montevideo 2022</div>
                                    <small style="color: #666;">
                                        Montevideo, Uruguay | 14/09/2022 | Estado: Rechazada
                                    </small>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Default/No editions state -->
                <div id="editions-default" class="editions-content">
                    <p style="padding: 15px; color: #666;">No hay ediciones disponibles.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get URL parameter for event ID
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? null : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Show the correct event content based on URL parameter
        function showEventContent() {
            const eventId = getUrlParameter('id');
            
            // Hide all event contents first
            const allEventContents = document.querySelectorAll('.event-content');
            const allEditionsContents = document.querySelectorAll('.editions-content');
            
            allEventContents.forEach(content => content.style.display = 'none');
            allEditionsContents.forEach(content => content.style.display = 'none');
            
            // Show the specific event content
            const eventElement = document.getElementById(`event-${eventId}`);
            const editionsElement = document.getElementById(`editions-${eventId}`);
            
            if (eventElement && editionsElement) {
                eventElement.style.display = 'block';
                editionsElement.style.display = 'block';
                
                // Update page title
                const eventTitle = eventElement.querySelector('h2').textContent;
                document.title = `${eventTitle} - eventos.uy`;
            } else {
                // Show default/error content
                document.getElementById('event-default').style.display = 'block';
                document.getElementById('editions-default').style.display = 'block';
                document.title = 'Evento no encontrado - eventos.uy';
            }
        }

        // Check login state and update UI
        function checkLoginState() {
            const currentUser = localStorage.getItem('currentUser');
            const guestAuth = document.getElementById('guestAuth');
            const userAuth = document.getElementById('userAuth');
            const profileSection = document.getElementById('profileSection');
            const profileLink = document.getElementById('profileLink');
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            const userImage = document.getElementById('userImage');
            const userInitial = document.getElementById('userInitial');
            const userProfileLink = document.getElementById('userProfileLink');
            
            if (currentUser) {
                const user = JSON.parse(currentUser);
                guestAuth.style.display = 'none';
                userAuth.style.display = 'block';
                profileSection.style.display = 'block';
                
                // Update user name in header
                userName.textContent = user.name;
                
                // Update profile links with user nickname
                profileLink.href = `user-profile.html?nickname=${user.nickname}`;
                userProfileLink.href = `user-profile.html?nickname=${user.nickname}`;
                
                // Update user avatar - try to show image, fallback to initial
                if (user.image) {
                    userImage.src = `../../imagens/${user.image}`;
                    userImage.alt = user.name;
                    userImage.style.display = 'block';
                    userInitial.style.display = 'none';
                    
                    // Handle image load error
                    userImage.onerror = function() {
                        userImage.style.display = 'none';
                        userInitial.style.display = 'flex';
                        userInitial.textContent = user.name.charAt(0).toUpperCase();
                    };
                } else {
                    userImage.style.display = 'none';
                    userInitial.style.display = 'flex';
                    userInitial.textContent = user.name.charAt(0).toUpperCase();
                }
                
                // Show/hide user-type-specific options
                const assistantLink = document.getElementById('assistantLink');
                const organizerLink1 = document.getElementById('organizerLink1');
                const organizerLink2 = document.getElementById('organizerLink2');
                const organizerLink3 = document.getElementById('organizerLink3');
                
                if (user.type === 'organizador') {
                    // Show organizer options, hide assistant options
                    if (assistantLink) assistantLink.style.display = 'none';
                    if (organizerLink1) organizerLink1.style.display = 'block';
                    if (organizerLink2) organizerLink2.style.display = 'block';
                    if (organizerLink3) organizerLink3.style.display = 'block';
                } else {
                    // Show assistant options, hide organizer options
                    if (assistantLink) assistantLink.style.display = 'block';
                    if (organizerLink1) organizerLink1.style.display = 'none';
                    if (organizerLink2) organizerLink2.style.display = 'none';
                    if (organizerLink3) organizerLink3.style.display = 'none';
                }
            } else {
                guestAuth.style.display = 'block';
                userAuth.style.display = 'none';
                profileSection.style.display = 'none';
            }
        }

        // Logout function
        function logout() {
            localStorage.removeItem('currentUser');
            window.location.reload();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            showEventContent();
            checkLoginState();
        });
    </script>

</body>
</html>
